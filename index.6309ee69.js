function t(){let t=window.devicePixelRatio,e=document.getElementById("myCanvas"),n=document.getElementById("canvasContainer");e.width=n.clientWidth,e.height=n.clientHeight;let i=n.getBoundingClientRect();return e.width=i.width*t,e.height=i.height*t,e.getContext("2d").scale(t,t),e.style.width=i.width+"px",e.style.height=i.height+"px",{canvas:e,context:e.getContext("2d")}}const e="#282a36",n="#ff79c6",i="#f8f8f2",o="#8be9fd",r="#f1fa8c",s="#8be9fd",c="#6272a4",l="#bd93f9";let a;!function(t){t[t.HL_NORMAL=0]="HL_NORMAL",t[t.HL_NUMBER=1]="HL_NUMBER",t[t.HL_STRING=2]="HL_STRING",t[t.HL_COMMENT=3]="HL_COMMENT",t[t.HL_KEYWORD1=4]="HL_KEYWORD1",t[t.HL_KEYWORD2=5]="HL_KEYWORD2"}(a||(a={}));const h=new Set(["export","import","new"]),u=new Set(h),f=["await","break","case","class","const","continue","debugger","default","delete","do","else","enum","export","extends","false","finally","for","function","if","implements","import","in","interface","let","new","null","package","private","protected","public","return","static","super","switch","this","throw","try","var"].concat([...h]);function w(t){return function(t){return 0===t.trim().length}(t)||"\0"===t||!!t.match("/^[,.()+-/*=~%<>;]/")}function d(t){const e=Array(t.length).fill(a.HL_NORMAL);let n,i=!0,o=0;for(;o<t.length;){const s=t[o];void 0!==n?(e.splice(o,1,a.HL_STRING),"\\"===s&&o+1<t.length&&(e.splice(o,1,a.HL_STRING),o++),s===n&&(n=void 0),i=!0):'"'!==s&&"'"!==s||(n=s,e.splice(o,1,a.HL_STRING)),(!isNaN(Number(s))&&(i||e[o-1]===a.HL_NUMBER)||"."==s&&e[o-1]==a.HL_NUMBER)&&e.splice(o,1,a.HL_NUMBER),"/"===(r=t)?.[0]&&"/"===r?.[1]&&(e.length=t.length,e.fill(a.HL_COMMENT),o=t.length);const c=i;if(i=w(s),c)for(const n of f){const r=n.length,s=t.slice(o,o+r).join("");if(s===n&&t[o+r]&&w(t[o+r])){const t=u.has(s);for(let n=0;n<r;n++)t?e.splice(o+n,1,a.HL_KEYWORD2):e.splice(o+n,1,a.HL_KEYWORD1);o+=r,i=!0;break}}o++}var r;return e}function g(t,h){!function(t,s){s.clearRect(0,0,t.width,t.height),s.fillStyle=e,s.fillRect(0,0,t.width,t.height);for(const[t,e]of y.text.entries()){y.textHL[t]=d(e.text),s.fillStyle=i;for(const[i,h]of e.entries())s.save(),y.textHL[t][i]===a.HL_NUMBER?s.fillStyle=l:y.textHL[t][i]===a.HL_STRING?s.fillStyle=r:y.textHL[t][i]===a.HL_COMMENT?s.fillStyle=c:y.textHL[t][i]===a.HL_KEYWORD1?s.fillStyle=n:y.textHL[t][i]===a.HL_KEYWORD2&&(s.fillStyle=o),s.fillText(h,b[0]*i,b[1]*(t+1)),s.restore()}}(t,h),function(t,e){e.save(),e.beginPath(),e.moveTo(N.X*b[0]+2,N.Y*b[1]+1),e.lineTo(N.X*b[0]+2,N.Y*b[1]+b[1]+4),e.lineWidth=2,e.strokeStyle=s,e.stroke(),e.restore()}(0,h)}class p{constructor(t){this._text=[],this._text=t||[]}clone(){return new p([...this._text])}get text(){return this._text}get length(){return this._text.length}charAtIndex(t){return this._text[t]}entries(){return this._text.entries()}concat(t){return this._text.concat(t.text),this}concatRaw(t){return this._text.concat(t),this}insertValueAt(t,e){this._text.splice(t,0,e)}push(t){this._text.push(t)}pop(){this._text.pop()}deleteValueAt(t){this._text.splice(t,1)}}let Y;!function(t){t.getFileContents=function(t){return t.text()},t.promptFileSelect=async function(){const t=await window.showOpenFilePicker({multiple:!1});return await t[0].getFile()}}(Y||(Y={}));const _=new Set(["[","{","(",'"',"'"]),x={"{":"}","[":"]","(":")",'"':'"',"'":"'"};function A(t){const e="Courier New";t.font=`16px ${e}`;return{font:e,fontSize:16,linePadding:4,charXY:[t.measureText(["a"].join("")).width,20]}}const{canvas:R,context:m}=t(),{font:L,fontSize:H,linePadding:v,charXY:b}=A(m),N=new class{constructor(){this.cursorX=0,this.cursorY=0,this.cursorVisible=!0}get X(){return this.cursorX}get Y(){return this.cursorY}setPosition([t,e]){this.cursorX=t,this.cursorY=e}get position(){return[this.cursorX,this.cursorY]}moveRight(t=1){this.cursorX+=t}moveLeft(t=1){this.cursorX-t>=0&&(this.cursorX-=t)}moveUp(t=1){this.cursorY-t>=0&&(this.cursorY-=t)}moveDown(t=1){this.cursorY+=t}},y=new class{constructor(){this._text=[new p],this._text_hl=[[]],this._buffer=[]}readFromFile(t){const e=t.split("\n");console.log(e);const n=[];for(const t of e)n.push(new p(t.split("")));this._text=n}get length(){return this.text.length}get buffer(){return this._buffer}addRowToBuffer(t){this._buffer.push(t.clone())}setBuffer(t){this._buffer=t.map((t=>t.clone()))}clearBuffer(){this._buffer=[]}get text(){return this._text}get textHL(){return this._text_hl}rowAt(t){return this._text[t]}charAt(t,e){const n=this._text[e];if(n)return n.text[t]}insertNewRowAt(t,e=new p){this._text.splice(t,0,e)}insertNewRowsAt(t,e=[]){this._text.splice(t,0,...e)}replaceRowAt(t,e){this._text[t]=e}removeRowAt(t){this._text.splice(t,1)}};document.addEventListener("keydown",(function(t){if(t.preventDefault(),t.metaKey||t.ctrlKey)switch(t.code){case"KeyO":Y.promptFileSelect().then((t=>Y.getFileContents(t).then((t=>{y.readFromFile(t),window.requestAnimationFrame((()=>g(R,m)))}))));break;case"KeyX":{y.clearBuffer(),y.addRowToBuffer(y.rowAt(N.Y)),y.length>1?y.removeRowAt(N.Y):(y.removeRowAt(N.Y),y.insertNewRowAt(N.Y,new p));const t=y.charAt(N.X,N.Y-1),e=y.rowAt(N.Y-1);t?N.moveUp():e&&N.setPosition([e.length,N.Y-1]);break}case"KeyC":y.clearBuffer(),y.addRowToBuffer(y.rowAt(N.Y));break;case"KeyV":y.insertNewRowsAt(N.Y,y.buffer),N.setPosition([y.rowAt(N.Y).length,N.Y])}else{let e=y.rowAt(N.Y);switch(t.code){case"Escape":case"MetaRight":case"MetaLeft":case"ShiftLeft":case"ShiftRight":break;case"ArrowLeft":N.moveLeft();break;case"ArrowRight":y.charAt(N.X,N.Y)?N.moveRight():y.rowAt(N.Y)&&N.setPosition([y.rowAt(N.Y).length,N.Y]);break;case"ArrowUp":{const t=y.charAt(N.X,N.Y-1),e=y.rowAt(N.Y-1);t?N.moveUp():e&&N.setPosition([e.length,N.Y-1]);break}case"ArrowDown":{const t=y.charAt(N.X,N.Y+1),e=y.rowAt(N.Y+1);t?N.moveDown():e&&N.setPosition([e.length,N.Y+1]);break}case"Enter":if(N.X===y.rowAt(N.Y).length)y.insertNewRowAt(N.Y+1),N.setPosition([0,N.Y+1]);else{const t=y.rowAt(N.Y),e=t.text.slice(0,N.X),n=t.text.slice(N.X,t.length);y.replaceRowAt(N.Y,new p(e)),y.insertNewRowAt(N.Y+1),y.replaceRowAt(N.Y+1,new p(n)),N.setPosition([0,N.Y+1])}break;case"Backspace":if(N.X>0)e.deleteValueAt(N.X-1),N.moveLeft();else if(y.text[N.Y-1]){const t=y.rowAt(N.Y-1).length,e=y.rowAt(N.Y-1).concat(y.text[N.Y]);y.replaceRowAt(N.Y-1,e),y.removeRowAt(N.Y),N.setPosition([t,N.Y-1])}break;case"Tab":e.push(" "),e.push(" "),e.push(" "),e.push(" "),N.moveRight(4);break;default:_.has(t.key)?(e.insertValueAt(N.X,t.key),N.moveRight(),e.insertValueAt(N.X,x[t.key])):(e.insertValueAt(N.X,t.key),N.moveRight())}}window.requestAnimationFrame((()=>g(R,m)))})),R.addEventListener("mousedown",(function(t){const[e,n]=function(t,e){const n=R.getBoundingClientRect();return[Math.round((t-n.left)/b[0]),Math.round((e-n.top)/b[1])-1]}(t.clientX,t.clientY);y.charAt(e,n)?N.setPosition([e,n]):y.rowAt(n)&&N.setPosition([y.rowAt(n).length,n]),window.requestAnimationFrame((()=>g(R,m)))})),window.addEventListener("resize",(()=>{t(),A(m),window.requestAnimationFrame((()=>g(R,m)))})),window.requestAnimationFrame((()=>g(R,m)));
//# sourceMappingURL=index.6309ee69.js.map
